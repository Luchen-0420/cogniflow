/* 博客编辑器自定义样式 */

/* Dialog 内容区域强制宽度 - 覆盖默认的 sm:max-w-lg */
.blog-editor-container,
.note-view-container {
  width: 95vw !important;
  max-width: 1400px !important;
  height: 85vh !important;
}

@media (min-width: 640px) {
  .blog-editor-container,
  .note-view-container {
    max-width: 1400px !important;
    height: 90vh !important;
  }
}

/* 编辑器容器优化 */
.blog-editor-wrapper {
  width: 100%;
  height: 100%;
}

/* MD Editor 响应式优化 */
.w-md-editor {
  box-shadow: none !important;
  width: 100% !important;
}

.blog-editor-container .w-md-editor,
.note-view-container .w-md-editor {
  min-width: 100% !important;
}

/* 移动端优化 */
@media (max-width: 640px) {
  /* 隐藏编辑器工具栏中不常用的按钮 */
  .w-md-editor-toolbar {
    flex-wrap: wrap;
    padding: 8px 4px !important;
  }

  .w-md-editor-toolbar-child {
    gap: 2px !important;
  }

  /* 调整编辑器和预览区域 */
  .w-md-editor-content {
    font-size: 14px;
  }

  /* 预览区域字体 */
  .wmde-markdown {
    font-size: 14px;
    padding: 12px !important;
  }

  /* 移动端预览模式切换 */
  .w-md-editor-show-preview .w-md-editor-input {
    display: none;
  }

  .w-md-editor-show-edit .w-md-editor-preview {
    display: none;
  }
}

/* PC 端优化 */
@media (min-width: 641px) {
  /* 16:9 比例优化 */
  .w-md-editor {
    aspect-ratio: auto;
  }

  /* 编辑区和预览区平分 - 默认 live 模式（有预览区） */
  .w-md-editor-content {
    display: flex;
  }

  /* 默认情况：live 模式，编辑区和预览区各占50% */
  .w-md-editor-input,
  .w-md-editor-preview {
    flex: 1;
    min-width: 0;
    box-sizing: border-box !important;
    flex-shrink: 1 !important;
    flex-grow: 1 !important;
    flex-basis: 0% !important;
  }

  /* 关键：当有预览区时（live模式），编辑区和预览区各占50% */
  /* 注意：show-preview 模式下预览区显示但编辑区隐藏，所以这里只处理 live 模式 */
  .w-md-editor:not(.w-md-editor-show-edit):not(.w-md-editor-show-preview) .w-md-editor-input,
  .w-md-editor:not(.w-md-editor-show-edit):not(.w-md-editor-show-preview) .w-md-editor-preview {
    max-width: 50% !important;
    flex: 1 1 50% !important;
  }

  /* 关键：当只有编辑区时（show-edit模式），编辑区占100%，预览区被隐藏 */
  .w-md-editor-show-edit .w-md-editor-input {
    max-width: 100% !important;
    flex: 1 1 100% !important;
    width: 100% !important;
  }

  /* show-preview 模式下，预览区占100%，编辑区被隐藏 */
  .w-md-editor-show-preview .w-md-editor-preview {
    max-width: 100% !important;
    flex: 1 1 100% !important;
    width: 100% !important;
  }

  /* 确保编辑区内的所有容器元素都限制在编辑区宽度内 */
  .w-md-editor-input > *,
  .w-md-editor-input .w-md-editor-text,
  .w-md-editor-input .w-md-editor-textarea {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* 预览区样式优化 */
  .wmde-markdown {
    padding: 20px !important;
    font-size: 16px;
    line-height: 1.8;
  }

  .wmde-markdown h1 {
    font-size: 2em;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }

  .wmde-markdown h2 {
    font-size: 1.5em;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }

  .wmde-markdown h3 {
    font-size: 1.25em;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }

  .wmde-markdown p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }

  .wmde-markdown pre {
    margin: 1em 0;
    padding: 1em;
    border-radius: 6px;
  }

  .wmde-markdown code {
    padding: 0.2em 0.4em;
    border-radius: 3px;
  }

  .wmde-markdown blockquote {
    margin: 1em 0;
    padding-left: 1em;
    border-left: 4px solid #ddd;
  }

  .wmde-markdown ul,
  .wmde-markdown ol {
    margin: 0.5em 0;
    padding-left: 2em;
  }

  .wmde-markdown li {
    margin: 0.25em 0;
  }
}

/* 深色模式优化 */
[data-color-mode="dark"] .w-md-editor {
  background-color: hsl(var(--background));
  color: hsl(var(--foreground));
}

[data-color-mode="dark"] .w-md-editor-toolbar {
  background-color: hsl(var(--muted));
  border-bottom-color: hsl(var(--border));
}

[data-color-mode="dark"] .wmde-markdown {
  background-color: hsl(var(--background));
  color: hsl(var(--foreground));
}

[data-color-mode="dark"] .wmde-markdown blockquote {
  border-left-color: hsl(var(--border));
  color: hsl(var(--muted-foreground));
}

/* 自动换行优化 */
/* 编辑器输入区域 - 自动换行 */
/* 关键：确保 textarea 基于其父容器（.w-md-editor-input）的实际宽度换行 */
/* 当有预览区时，.w-md-editor-input 占50%，textarea 应该基于这50%的宽度换行 */
/* 当只有编辑区时，.w-md-editor-input 占100%，textarea 应该基于这100%的宽度换行 */
.w-md-editor-text,
.w-md-editor-textarea,
.w-md-editor-input textarea,
.w-md-editor-input .w-md-editor-text-text,
textarea.w-md-editor-text-text,
.w-md-editor textarea,
.w-md-editor-input textarea[wrap],
.blog-editor-container textarea,
.note-view-container textarea {
  word-wrap: break-word !important;
  word-break: break-word !important;
  white-space: pre-wrap !important;
  overflow-wrap: break-word !important;
  hyphens: auto !important;
  overflow-x: hidden !important;
  /* 关键：width: 100% 是相对于 .w-md-editor-input 的，确保填充父容器 */
  /* textarea 会自动根据父容器的实际宽度（50%或100%）进行换行 */
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
  min-width: 0 !important;
}

/* 预览区域 - 自动换行 */
.wmde-markdown,
.wmde-markdown p,
.wmde-markdown li,
.wmde-markdown td,
.wmde-markdown th {
  word-wrap: break-word !important;
  word-break: break-word !important;
  overflow-wrap: break-word !important;
  hyphens: auto !important;
}

/* 代码块保持不换行（代码块应该保持原样） */
.wmde-markdown pre,
.wmde-markdown code:not(pre code) {
  word-wrap: normal !important;
  word-break: normal !important;
  white-space: pre !important;
  overflow-x: auto !important;
}

/* 确保编辑器容器支持换行 */
.w-md-editor-input {
  overflow-x: hidden !important;
  overflow-y: auto !important;
  width: 100% !important;
  box-sizing: border-box !important;
  /* 确保 flex 布局时正确计算宽度 */
  flex-shrink: 1 !important;
  flex-grow: 1 !important;
  flex-basis: 0% !important;
}

/* PC端：根据预览区状态动态调整编辑区宽度 */
@media (min-width: 641px) {
  /* 有预览区时（live模式），编辑区占50% */
  .w-md-editor:not(.w-md-editor-show-edit):not(.w-md-editor-show-preview) .w-md-editor-input {
    max-width: 50% !important;
    flex: 1 1 50% !important;
  }

  /* 只有编辑区时（show-edit模式），编辑区占100%，预览区被隐藏 */
  .w-md-editor-show-edit .w-md-editor-input {
    max-width: 100% !important;
    flex: 1 1 100% !important;
    width: 100% !important;
  }
}

/* 编辑器输入区域容器 */
/* 关键：确保这个容器也限制在 .w-md-editor-input 的宽度内 */
.w-md-editor-input .w-md-editor-text {
  width: 100% !important;
  max-width: 100% !important;
  min-width: 0 !important;
  overflow-x: hidden !important;
  overflow-y: auto !important;
  box-sizing: border-box !important;
}

.w-md-editor-preview {
  overflow-x: hidden !important;
  overflow-y: auto !important;
}

/* 表格自动换行 */
.wmde-markdown table {
  table-layout: auto !important;
  width: 100% !important;
  word-wrap: break-word !important;
}

.wmde-markdown table td,
.wmde-markdown table th {
  word-wrap: break-word !important;
  word-break: break-word !important;
  max-width: 0 !important;
}

/* 链接自动换行 */
.wmde-markdown a {
  word-break: break-all !important;
  overflow-wrap: break-word !important;
}

/* 滚动条优化 */
.w-md-editor-text,
.wmde-markdown-var {
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--muted-foreground)) transparent;
}

.w-md-editor-text::-webkit-scrollbar,
.wmde-markdown-var::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.w-md-editor-text::-webkit-scrollbar-track,
.wmde-markdown-var::-webkit-scrollbar-track {
  background: transparent;
}

.w-md-editor-text::-webkit-scrollbar-thumb,
.wmde-markdown-var::-webkit-scrollbar-thumb {
  background-color: hsl(var(--muted-foreground));
  border-radius: 4px;
}

.w-md-editor-text::-webkit-scrollbar-thumb:hover,
.wmde-markdown-var::-webkit-scrollbar-thumb:hover {
  background-color: hsl(var(--foreground));
}

/* 加载状态 */
.w-md-editor-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 200px;
}
