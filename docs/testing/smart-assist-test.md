# 智能输入助手功能测试文档

## 📋 功能概述

智能输入助手（功能一）是 CogniFlow 的核心功能之一，当用户开始新的调研或学习任务时，系统自动关联历史相关资料、分析知识缺口、推荐补充资源。

## 🎯 测试目标

验证以下功能是否正常工作：
1. ✅ 触发条件判断
2. ✅ 历史关联检索
3. ✅ 缺口分析
4. ✅ 外部推荐
5. ✅ UI 交互操作

---

## 🧪 测试用例

### 测试用例 1：触发条件测试

#### 测试场景 1.1：关键词触发
**步骤：**
1. 在输入框输入包含调研关键词的内容（至少50字）
2. 例如：`调研 AI Agent 产品的竞品分析，需要了解主流产品的技术架构、商业模式和用户规模`
3. 提交输入

**预期结果：**
- ✅ 智能助手侧边栏自动打开
- ✅ 显示"正在分析「调研 AI Agent 产品的竞品分析...」"
- ✅ 开始加载历史关联数据

**验证点：**
- [ ] 侧边栏正确显示
- [ ] 主题提取正确
- [ ] 加载状态显示正常

---

#### 测试场景 1.2：标签触发
**步骤：**
1. 创建一条资料类型的卡片
2. 添加标签：`#调研` 或 `#学习` 或 `#分析`
3. 内容长度 > 50 字

**预期结果：**
- ✅ 智能助手自动触发
- ✅ 显示相关历史资料

**验证点：**
- [ ] 标签匹配正确
- [ ] 触发逻辑正确

---

#### 测试场景 1.3：类型触发
**步骤：**
1. 输入：`资料：AI Agent 技术文档整理`
2. 内容长度 > 50 字

**预期结果：**
- ✅ 智能助手自动触发

**验证点：**
- [ ] 类型检测正确

---

#### 测试场景 1.4：不触发场景
**步骤：**
1. 输入简短内容（< 50 字）：`今天要开会`
2. 输入普通任务：`明天完成项目报告`

**预期结果：**
- ✅ 智能助手不触发
- ✅ 正常创建条目

**验证点：**
- [ ] 长度过滤正确
- [ ] 非调研内容不触发

---

### 测试用例 2：历史关联检索测试

#### 测试场景 2.1：有相关历史资料
**前置条件：**
- 系统中已有相关主题的笔记/资料

**步骤：**
1. 输入：`调研 React 性能优化方案`
2. 提交

**预期结果：**
- ✅ 显示相关历史资料（最多5条）
- ✅ 按相关度排序
- ✅ 显示标题、创建时间、摘要、相关度分数
- ✅ 相关度分数在 0-100 之间

**验证点：**
- [ ] 搜索结果准确
- [ ] 相关度计算合理
- [ ] 显示格式正确
- [ ] 响应时间 < 0.5秒（第一层）

---

#### 测试场景 2.2：无相关历史资料
**前置条件：**
- 系统中没有相关主题的资料

**步骤：**
1. 输入全新的调研主题：`调研量子计算在金融领域的应用`
2. 提交

**预期结果：**
- ✅ 显示"暂无相关历史资料"
- ✅ 不显示历史关联列表

**验证点：**
- [ ] 空状态显示正确
- [ ] 不报错

---

#### 测试场景 2.3：关键词提取
**步骤：**
1. 输入：`我想了解人工智能在医疗诊断中的应用，特别是深度学习模型`
2. 提交

**预期结果：**
- ✅ 正确提取关键词：`人工智能`、`医疗诊断`、`深度学习`、`模型`
- ✅ 搜索到相关条目

**验证点：**
- [ ] 关键词提取准确
- [ ] 停用词过滤正确

---

### 测试用例 3：缺口分析测试

#### 测试场景 3.1：有历史资料的分析
**前置条件：**
- 有 3-5 条相关历史资料

**步骤：**
1. 输入调研主题
2. 等待缺口分析完成

**预期结果：**
- ✅ 显示知识完整度分数（0-100）
- ✅ 显示知识缺口（如有）
- ✅ 显示时效性提醒
- ✅ 显示建议操作
- ✅ 显示调研大纲

**验证点：**
- [ ] 完整度分数计算合理
- [ ] 缺口描述准确
- [ ] 时效性判断正确（>30天提示更新）
- [ ] 建议操作有意义

---

#### 测试场景 3.2：无历史资料的分析
**前置条件：**
- 没有相关历史资料

**步骤：**
1. 输入全新的调研主题
2. 等待分析完成

**预期结果：**
- ✅ 完整度分数较低（< 40）
- ✅ 显示"暂无相关历史资料，建议开始收集基础信息"
- ✅ 建议"补充资料"

**验证点：**
- [ ] 空状态分析正确
- [ ] 建议合理

---

#### 测试场景 3.3：时效性检查
**前置条件：**
- 有相关历史资料，但最新的一条超过30天

**步骤：**
1. 输入调研主题
2. 查看时效性提醒

**预期结果：**
- ✅ 显示"最新资料已超过30天，建议更新"
- ✅ `needsUpdate` 为 `true`

**验证点：**
- [ ] 时间计算正确
- [ ] 提醒信息准确

---

### 测试用例 4：交互操作测试

#### 测试场景 4.1：加载历史资料
**步骤：**
1. 在历史关联列表中点击"加载"按钮

**预期结果：**
- ✅ 显示成功提示："已加载：[标题]"
- ✅ 在控制台输出条目信息

**验证点：**
- [ ] 按钮响应正常
- [ ] 数据加载成功
- [ ] 提示信息正确

---

#### 测试场景 4.2：预览历史资料
**步骤：**
1. 在历史关联列表中点击"预览"按钮

**预期结果：**
- ✅ 显示预览提示："预览：[标题]"
- ✅ 在控制台输出条目信息

**验证点：**
- [ ] 按钮响应正常
- [ ] 预览功能正常

---

#### 测试场景 4.3：生成调研大纲
**步骤：**
1. 等待缺口分析完成
2. 点击"生成调研大纲"按钮

**预期结果：**
- ✅ 大纲复制到剪贴板
- ✅ 显示成功提示："调研大纲已复制到剪贴板"
- ✅ 或显示大纲内容（如果剪贴板不可用）

**验证点：**
- [ ] 大纲格式正确
- [ ] 复制功能正常
- [ ] 提示信息正确

---

#### 测试场景 4.4：创建子任务
**步骤：**
1. 等待缺口分析完成
2. 点击"创建子任务"按钮

**预期结果：**
- ✅ 显示提示："创建子任务功能开发中..."
- ✅ 不报错

**验证点：**
- [ ] 按钮可点击
- [ ] 提示信息正确

---

#### 测试场景 4.5：添加外部推荐
**步骤：**
1. 在推荐资料列表中点击"添加"按钮

**预期结果：**
- ✅ 在新标签页打开 URL
- ✅ 显示成功提示："已在新标签页打开"

**验证点：**
- [ ] URL 打开正确
- [ ] 提示信息正确

---

### 测试用例 5：UI/UX 测试

#### 测试场景 5.1：侧边栏显示
**步骤：**
1. 触发智能助手

**预期结果：**
- ✅ 侧边栏从右侧滑入
- ✅ 不遮挡主编辑区域
- ✅ 可以关闭（点击遮罩或关闭按钮）

**验证点：**
- [ ] 动画流畅
- [ ] 布局合理
- [ ] 关闭功能正常

---

#### 测试场景 5.2：加载状态
**步骤：**
1. 触发智能助手
2. 观察加载过程

**预期结果：**
- ✅ 显示加载动画
- ✅ 显示"正在加载..."文字
- ✅ 数据加载完成后隐藏加载状态

**验证点：**
- [ ] 加载状态显示正确
- [ ] 用户体验良好

---

#### 测试场景 5.3：响应式设计
**步骤：**
1. 在不同屏幕尺寸下测试（手机、平板、桌面）

**预期结果：**
- ✅ 侧边栏宽度自适应
- ✅ 内容可滚动
- ✅ 按钮大小合适

**验证点：**
- [ ] 移动端显示正常
- [ ] 桌面端显示正常

---

## 🐛 已知问题

1. **创建子任务功能**：目前仅显示提示，实际功能待开发
2. **外部推荐**：目前使用模拟数据，真实推荐功能待实现
3. **缺口分析**：目前基于简单规则，AI 深度分析待实现

---

## 📊 性能指标

### 目标指标（来自 TOOD.md）

| 指标 | 目标值 | 测试方法 |
|------|--------|----------|
| 触发率 | ≥ 60% | 统计调研类卡片中触发的比例 |
| 采纳率 | ≥ 50% | 统计用户接受推荐的比例 |
| 准确率 | ≥ 80% | 人工评估推荐的准确性 |
| 响应速度 | < 0.5s | 第一层推荐的加载时间 |

### 实际测试结果

请在测试时记录：
- [ ] 第一层响应时间：_____ 秒
- [ ] 第二层响应时间：_____ 秒
- [ ] 推荐准确率：_____ %
- [ ] 用户采纳率：_____ %

---

## ✅ 测试检查清单

### 功能完整性
- [ ] 触发条件判断正确
- [ ] 历史关联检索正常
- [ ] 缺口分析正常
- [ ] 外部推荐显示正常
- [ ] 所有交互操作正常

### 代码质量
- [ ] 无控制台错误
- [ ] 无 TypeScript 类型错误
- [ ] 代码符合项目规范

### 用户体验
- [ ] UI 美观易用
- [ ] 加载状态清晰
- [ ] 错误提示友好
- [ ] 响应速度满足要求

---

## 🚀 快速测试脚本

### 测试数据准备

1. **创建测试笔记**（用于历史关联测试）：
   ```
   笔记：React 性能优化技巧
   内容：使用 React.memo 可以避免不必要的重渲染，useCallback 和 useMemo 可以优化函数和值的计算...
   ```

2. **创建测试资料**（用于类型触发测试）：
   ```
   资料：AI Agent 技术架构分析
   内容：AI Agent 的核心技术包括多模态交互、工具调用、记忆管理等...
   ```

### 快速测试流程

1. **测试触发**：
   - 输入：`调研 React 性能优化方案，需要了解最新的优化技巧和最佳实践`
   - 预期：智能助手自动打开

2. **测试历史关联**：
   - 检查是否显示相关笔记
   - 检查相关度分数是否合理

3. **测试缺口分析**：
   - 等待分析完成
   - 检查完整度分数
   - 检查建议是否合理

4. **测试交互**：
   - 点击"加载"按钮
   - 点击"生成调研大纲"按钮
   - 检查功能是否正常

---

## 📝 测试报告模板

```
测试日期：____年__月__日
测试人员：___________

### 测试结果汇总
- 总测试用例数：___
- 通过：___
- 失败：___
- 阻塞：___

### 主要问题
1. [问题描述]
   - 严重程度：高/中/低
   - 影响范围：_______
   - 建议修复时间：_______

### 性能数据
- 第一层响应时间：___ 秒
- 第二层响应时间：___ 秒
- 推荐准确率：___ %

### 建议
1. _______
2. _______
```

---

## 🔗 相关文档

- [功能设计文档](../../TOOD.md#功能一智能输入助手)
- [开发指南](../development/DEVELOPER_GUIDE.md)
- [API 文档](../api/)

---

**最后更新**：2024-11-13  
**版本**：v1.0

